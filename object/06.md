# 06 메시지와 인터페이스

> 퍼블릭 인터페이스를 잘 구성하는 원칙과 기법

:pushpin: 객체지향은 객체들 간 주고 받는 메시지가 중요하다. 이 메시지는 퍼블릭 인터페이스를 구성하고, 이를 장 구성하기 위해 사용되는 원칙과 기법을 살펴본다.



### 01 협력과 메시지

> 먼저 혼란스러운 용어 부터 정리한다.

#### 클라이언트-서버 모델

어떤 객체와 다른 객체가 협력하는데, 메시지를 보내는 쪽은 Client, 받는 쪽은 Server라고 한다.



#### 메시지와 메시지 전송

:baby_chick: 메시지: ​ 협력에 필요한 의사소통 수단

:baby_chick: 메시지 전송: 한 객체가 다른 객체에게 도움을 요청하는 것



#### 메시지와 메서드

메시지 송신자는 자신이 보낼 메시지만 알면되고, 수신자는 메시지의 도착 사실만 알면된다.

​	:baby_chick: 서로에 대해 상세히 몰라도, 실행시간에 둘은 연결된다.



#### 퍼블릭 인터페이스와 오퍼레이션

:baby_chick: 퍼블릭 인터페이스: 의사소통을 위해 외부에 공개하는 메시지의 집합

:baby_chick: 오퍼레이션: 프로그래밍 언어적 관점에서 퍼블릭 인터페이스에 포함된 메시지를 오퍼레이션이라고 부른다. 이는 수행가능한 어떤 행동에 대한 추상화 이다.



#### 시그니처

오퍼레이션의 이름과 파라미터 목록을 합쳐 시그니쳐라고 부른다.



### 02 인터페이스와 설계 품질

Public 인터페이스에 영향을 미치는 4가지 요소

1. 디미터 법칙: 메시지 수신자에게 내부 구조를 묻지 않는다.

   낯선 자에게 마랗지 말라, 오직 하나의 도트만 사용하라

2. 묻지 말고 시켜라

3. 의도를 드러내는 인터페이스

4. 명령-쿼리 분리



#### 묻지 말고 시켜라

객체의 내부상태를 물어 로직을 처리 하지 말고, 해당 객체에 시켜라



#### 의도를 드러내는 인터페이스

인터페이스의 이름을 지을때 무엇을 하는지 드러내라. 그리고, 메소드 이름을 일반화 하라



#### 함께 모으기

1장의 티켓 판매 도메인을 통해 디미터 법칙, 묻지 말고 시켜라, 의도를 드러내는 인터페이스의 위반 사례를 알 수 있다.



:paperclip: 디미터 법칙을 위반하는 티켓 판매 도메인 

디미터 법칙을 어기면 다른 객체의 내부 구조(구현)을 모두 잘 알아야 한다.

:paperclip: 묻지 말고 시켜라

TicketSeller에게 Ticket를 가져와 고객에게 넣어주는 것이 아니라 TicketSeller에게 고객의 가방에 Ticket을 넣으라고 시킨다.

:paperclip: 인터페이스에 의도를 드러내자

Theather, TicketSeller, Audience, Bag 모두 setTicket() 메소드를 가지고 있지만 의미는 서로 다르다. 그 차이점을 메소드에 표현하자.



### 03 원칙의 함정

법칙, 원칙은 항상 맞는게 아니므로 언제 사용되는지 알아야 한다.



#### 디미터 법칙은 하나의 도트(.)를 강제하는 규칙이 아니다



#### 결합도와 응집도의 충돌

PeriodCondition은 기간에 따라 할인율이 다른데 그 기간은 Screeening이 가지고 있다. 그래서 PeriodCondition이 Screening의 인스턴스 변수를 묻는다. 하지만 이는 묻지 말고 시켜라가 아니다. 그렇지만 Screening에 할인조건 판단 책임을 부과하는건 옳지 않다.



### 04 명령-쿼리 분리 원칙

명령은 상태를 변화시키지만 반환값이 없고, 쿼리는 상태를 안 변화시키지만, 반환값이 있다. 

> 그래서 명령과 쿼리를 분리 하면 뭐가 좋을까??



#### 반복 일정의 명령과 쿼리 분리하기

쿼리에 명령이 같이 있어서 문제점을 야기한다.?? 어떤 문제점??

- 스케쥴러를 구현할때, 명령과 쿼리가 함께 있을 경우 생각하지도 못한 부분에서 명령을 통한 상태 변경이 일어나 버그를 야기시킬 수 있다.



#### 명령-쿼리 분리와 참조 투명성

객체지향 프로그래밍은 명령 기반 프로그래밍 이지만, 명령과 쿼리를 분리하여 제한적으로 참조 투명성 효과를 누릴 수 있다.

> 아직 참조 투명성의 이점을 확실히 이해하지 못했다.



#### 책임에 초점을 맞춰라



##### 

##### 

##### 







