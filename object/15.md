# 15. 디자인 패턴과 프레임워크

sw 설계에서 반복적으로 나오는 문제 정의 해결책에 대해 정리한 것을 디자인 패턴이라고 한다. 프레임워크는 일관성있는 협력을 제공하는 확장가능한 코드이다.



## 01 디자인 패턴과 설계 재사용

### 소프트웨어 패턴

패턴은 반복적으로 사용되는 문제와 해법이고, 이를 사용하면 높은 수준의 대화가 가능하다. 연관된 패턴들의 집합은 패턴 언어를 형성한다.



### 패턴 분류

아키텍쳐 패턴 > 디자인 패턴 > 미디엄

- 아키텍쳐 패턴은 서브 시스템들의 책임을 정의한다.



### 패턴과 책임-주도 설계

디자인 패턴의 구성요소는 클래스가 아니라 '역할'이고 클래스나 메서드가 구성이 달라져도 역할을 다한다면 패턴은 유지된다.



### 캡슐화와 디자인 패턴

어떤 패턴이 어떤 변경 사항을 캡슐화 했는지가 중요하다.

STRATEGY 패턴은 변경사항을 캡슐화하기 위해 합성을 사용한다. 변경사항을 서브클래스로 두는 슈퍼클래스를 Client와 합성하여 사용한다.

Template Method 패턴은 클래스의 메소드를 추상화 하여 기본구조를 정한 후 구체적인 단계는 자식클래스에서 정의하게 함으로써 변경을 캡슐화한 패턴이다. 이는 STRATEGY 패턴처럼 Runtime에 서브클래스를 바꿔치기 할 수는 없지만(상속) 만약 그럴 필요 없다면, 상대적으로 복잡도를 낮출 수 있다.

DECORATOR 패턴은 핸드폰 과금 시스템 처럼 객체의 행동을 동적으로 추가할 수 있게 해주는 패턴이다. 기본적으로 합성을 사용하여 행동을 추가해준다. SearchQuery에서 subAggregation을 설정할때 이 패턴이 사용된 것 같다.



### 패턴은 출발점이다.

패턴을 현재 상황에 맞게 적용하는 것이 중요하다. 패턴을 이용해 리팩토링 하는 이유를 아는 것이 더 중요하다.



## 02 프레임워크와 코드 재사용

### 코드 재사용 대 설계 재사용

컴포넌트를 만들어 도메인마다 코드를 재사용 하기엔 도메인이 너무 다양해 현실성이 없다. 설계를 재사용하기엔 구현코드를 매번 작성해야한다. 그래서 설계를 재사용하면서 구현코드도 어느정도 재사용 할 수 있는것이 프레임워크다.



### 상위 정책과 하위 정책으로 패키지 분리하기

변경되는것을 추상화 하고, 변경에 안정적인 상위정책(추상화된 정책)을 패키지로 분리한다. 그리고 별도의 배포 단위로 만들면 프레임 워크가 완성된다.



### 제어 역전 원리

시스템 협력 흐름 재사용을 위해 IoC를 사용한다.??

```
대신 서블릿에 대한 제어 권한을 가진 컨테이너가 적절한 시점에 서블릿 클래스의 오브젝트를 만들고 그 안에 메서드를 호출한다.
템플릿 메서드 패턴에서도 제어의 역전 개념이 적용되었다. 추상 UserDao를 상속한 서브 클래스는 getConnection()을 구현한다. 하지만 이 메서드가 언제 어떻게 사용될지 자신은 모른다. 서브 클래스에서 결정되는 것이 아니다. 단지 이런 방식으로 DB 커넥션을 만든다는 기능만 구현해놓으면, 슈퍼 클래스인 UserDao의 템플릿 메서드 add(), get() 등에서 필요할 때 호출해서 사용하는 것이다. 즉, 제어권을 상위 템플릿 메서드에 넘기고 자신은 필요할 때 호출되어 사용되도록 한다는 개념이다.
```



https://yangbongsoo.gitbook.io/study/spring-1/basic

